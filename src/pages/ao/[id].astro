---
import { GraphQLClient } from "graphql-request";
import Layout from "@/layouts/Layout.astro";

// Create a new GraphQL client with the Hygraph endpoint
const client = new GraphQLClient("https://f3rapidcity.com/graphql");

// Declare AO type
type AO = {
  aO: {
    title: string;
    aoDetails: {
      aoAddress: string;
      aoDetails: string;
      aoAddressLabel: string;
      googleMapEmbed: string;
    };
    featuredImage: {
      node: {
        mediaItemUrl: string;
      };
    };
  };
};

// Get the id from the URL parameters
const { id } = Astro.params;

// Fetch the data via the GraphQL query
const { aO }: AO = await client.request(
  `
query NewQuery($id: ID!) {
  aO(id: $id, idType: SLUG) {
    title
    aoDetails {
      aoAddress
      aoDetails
      aoAddressLabel
      googleMapEmbed
    }
    featuredImage {
      node {
        mediaItemUrl
      }
    }
  }
}`,
  { id },
);

console.log(aO);
---

<Layout title={`${aO?.title} AO`}>
  <div class="relative flex justify-center items-center h-80 bg-cover bg-center" style={`background-image: url(${aO?.featuredImage?.node?.mediaItemUrl})`}>
    <div class="absolute inset-0 bg-black opacity-50"></div>
    <h1 class="relative text-primary font-extrabold text-5xl">{aO?.title}</h1>
  </div>
  <div class="text-center mt-10">
    <p>Keep an eye out for the shovel flags to find the exact workout spot.</p>
    <h2 class="text-3xl font-bold mt-4 mb-2">Location</h2>
    <p>{aO?.aoDetails?.aoAddressLabel}</p>
    <p>{aO?.aoDetails?.aoAddress}</p>
    <h2 class="text-3xl font-bold mt-4 mb-2">Details</h2>
    <div set:html={aO?.aoDetails?.aoDetails} />

    <div class="mt-10 mb-2">
      <iframe
        width="100%"
        height="450"
        frameborder="0"
        style="border:0"
        src={aO?.aoDetails?.googleMapEmbed}
        allowfullscreen
      ></iframe>
  </div>
</Layout>